server:
  http_listen_port: {{ promtail_config.server.http_listen_port }}
  grpc_listen_port: {{ promtail_config.server.grpc_listen_port }}
positions:
  filename: {{ promtail_config.positions.filename }}
scrape_configs:
{%- for scrape_config in promtail_scrape_configs %}
- job_name: {{ scrape_config.job_name }}
  static_configs:
  - targets: [{{ scrape_config.targets }}]
    labels:
      job: {{ scrape_config.job_name }}
  relabel_configs:
  {%- for relabel_config in scrape_config.relabel_configs %}
  - {{ relabel_config | to_nice_yaml(indent=6) }}
  {%- endfor %}
  pipeline_stages:
  {%- for pipeline_stage in scrape_config.pipeline_stages %}
  - {{ pipeline_stage | to_nice_yaml(indent=6) }}
  {%- endfor %}
{%- endfor %}
